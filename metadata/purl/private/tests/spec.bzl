# Generated by maintainers/tools/purl_spec_tests/main.py. DO NOT EDIT.
#
# Source: https://github.com/package-url/purl-spec

visibility([
    "//purl/private/tests/...",
])

tests = [
    {
        "description": "valid hackage purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/AC-HalfInteger@1.2.1",
        "input": "pkg:hackage/AC-HalfInteger@1.2.1",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid hackage purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "AC-HalfInteger",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "1.2.1",
        },
        "input": "pkg:hackage/AC-HalfInteger@1.2.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid hackage purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/AC-HalfInteger@1.2.1",
        "input": "pkg:hackage/AC-HalfInteger@1.2.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid hackage purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/AC-HalfInteger@1.2.1",
        "input": {
            "name": "AC-HalfInteger",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "1.2.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "name and version are always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:hackage",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "name and version are always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:hackage",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "name and version are always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "a50",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "0.5",
        },
        "input": "pkg:hackage/a50@0.5",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/a50@0.5",
        "input": "pkg:hackage/a50@0.5",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/a50@0.5",
        "input": {
            "name": "a50",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "0.5",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "AC-HalfInteger",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "1.2.1",
        },
        "input": "pkg:hackage/AC-HalfInteger@1.2.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/AC-HalfInteger@1.2.1",
        "input": "pkg:hackage/AC-HalfInteger@1.2.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/AC-HalfInteger@1.2.1",
        "input": {
            "name": "AC-HalfInteger",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "1.2.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "3d-graphics-examples",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "0.0.0.2",
        },
        "input": "pkg:hackage/3d-graphics-examples@0.0.0.2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/3d-graphics-examples@0.0.0.2",
        "input": "pkg:hackage/3d-graphics-examples@0.0.0.2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hackage",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hackage/3d-graphics-examples@0.0.0.2",
        "input": {
            "name": "3d-graphics-examples",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hackage",
            "version": "0.0.0.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "pacman",
            "namespace": "arch",
            "qualifiers": {
                "arch": "x86_64",
            },
            "subpath": None,
            "type": "alpm",
            "version": "6.0.1-1",
        },
        "input": "pkg:alpm/arch/pacman@6.0.1-1?arch=x86_64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/pacman@6.0.1-1?arch=x86_64",
        "input": "pkg:alpm/arch/pacman@6.0.1-1?arch=x86_64",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/pacman@6.0.1-1?arch=x86_64",
        "input": {
            "name": "pacman",
            "namespace": "arch",
            "qualifiers": {
                "arch": "x86_64",
            },
            "subpath": None,
            "type": "alpm",
            "version": "6.0.1-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "python-pip",
            "namespace": "arch",
            "qualifiers": {
                "arch": "any",
            },
            "subpath": None,
            "type": "alpm",
            "version": "21.0-1",
        },
        "input": "pkg:alpm/arch/python-pip@21.0-1?arch=any",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/python-pip@21.0-1?arch=any",
        "input": "pkg:alpm/arch/python-pip@21.0-1?arch=any",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/python-pip@21.0-1?arch=any",
        "input": {
            "name": "python-pip",
            "namespace": "arch",
            "qualifiers": {
                "arch": "any",
            },
            "subpath": None,
            "type": "alpm",
            "version": "21.0-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "containers-common",
            "namespace": "arch",
            "qualifiers": {
                "arch": "x86_64",
            },
            "subpath": None,
            "type": "alpm",
            "version": "1:0.47.4-4",
        },
        "input": "pkg:alpm/arch/containers-common@1:0.47.4-4?arch=x86_64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/containers-common@1:0.47.4-4?arch=x86_64",
        "input": "pkg:alpm/arch/containers-common@1:0.47.4-4?arch=x86_64",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: alpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:alpm/arch/containers-common@1:0.47.4-4?arch=x86_64",
        "input": {
            "name": "containers-common",
            "namespace": "arch",
            "qualifiers": {
                "arch": "x86_64",
            },
            "subpath": None,
            "type": "alpm",
            "version": "1:0.47.4-4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "CPAN distribution name are case sensitive. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55",
        "input": "pkg:cpan/DROLSKY/DateTime@1.55",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "CPAN distribution name are case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "DateTime",
            "namespace": "DROLSKY",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "1.55",
        },
        "input": "pkg:cpan/DROLSKY/DateTime@1.55",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "CPAN distribution name are case sensitive. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55",
        "input": "pkg:cpan/DROLSKY/DateTime@1.55",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "CPAN distribution name are case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55",
        "input": {
            "name": "DateTime",
            "namespace": "DROLSKY",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "1.55",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "CPAN distribution without author",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "Perl-Version",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "1.013",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "CPAN with just the module name and version",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:cpan/LWP::UserAgent@6.7.6",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "CPAN distribution name as module name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:cpan/GDT/URI::PackageURL",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "CPAN distribution name like module name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "URI::PackageURL",
            "namespace": "GDT",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Roundtrip test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55",
        "input": "pkg:cpan/DROLSKY/DateTime@1.55",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55",
        "input": {
            "name": "DateTime",
            "namespace": "DROLSKY",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "1.55",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "URI-PackageURL",
            "namespace": "GDT",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": None,
        },
        "input": "pkg:cpan/GDT/URI-PackageURL",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/GDT/URI-PackageURL",
        "input": "pkg:cpan/GDT/URI-PackageURL",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/GDT/URI-PackageURL",
        "input": {
            "name": "URI-PackageURL",
            "namespace": "GDT",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "libwww-perl",
            "namespace": "OALDERS",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "6.76",
        },
        "input": "pkg:cpan/OALDERS/libwww-perl@6.76",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/OALDERS/libwww-perl@6.76",
        "input": "pkg:cpan/OALDERS/libwww-perl@6.76",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/OALDERS/libwww-perl@6.76",
        "input": {
            "name": "libwww-perl",
            "namespace": "OALDERS",
            "qualifiers": None,
            "subpath": None,
            "type": "cpan",
            "version": "6.76",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Roundtrip test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55?repository_url=backpan.perl.org",
        "input": "pkg:cpan/DROLSKY/DateTime@1.55?repository_url=backpan.perl.org",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Parse test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "DateTime",
            "namespace": "DROLSKY",
            "qualifiers": {
                "repository_url": "backpan.perl.org",
            },
            "subpath": None,
            "type": "cpan",
            "version": "1.55",
        },
        "input": "pkg:cpan/DROLSKY/DateTime@1.55?repository_url=backpan.perl.org",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Build test for PURL type: cpan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cpan/DROLSKY/DateTime@1.55?repository_url=backpan.perl.org",
        "input": {
            "name": "DateTime",
            "namespace": "DROLSKY",
            "qualifiers": {
                "repository_url": "backpan.perl.org",
            },
            "subpath": None,
            "type": "cpan",
            "version": "1.55",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "AFNetworking",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cocoapods",
            "version": "4.0.1",
        },
        "input": "pkg:cocoapods/AFNetworking@4.0.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/AFNetworking@4.0.1",
        "input": "pkg:cocoapods/AFNetworking@4.0.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/AFNetworking@4.0.1",
        "input": {
            "name": "AFNetworking",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cocoapods",
            "version": "4.0.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "MapsIndoors",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cocoapods",
            "version": "3.24.0",
        },
        "input": "pkg:cocoapods/MapsIndoors@3.24.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/MapsIndoors@3.24.0",
        "input": "pkg:cocoapods/MapsIndoors@3.24.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/MapsIndoors@3.24.0",
        "input": {
            "name": "MapsIndoors",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cocoapods",
            "version": "3.24.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "ShareKit",
            "namespace": None,
            "qualifiers": None,
            "subpath": "Twitter",
            "type": "cocoapods",
            "version": "2.0",
        },
        "input": "pkg:cocoapods/ShareKit@2.0#Twitter",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/ShareKit@2.0#Twitter",
        "input": "pkg:cocoapods/ShareKit@2.0#Twitter",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/ShareKit@2.0#Twitter",
        "input": {
            "name": "ShareKit",
            "namespace": None,
            "qualifiers": None,
            "subpath": "Twitter",
            "type": "cocoapods",
            "version": "2.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "GoogleUtilities",
            "namespace": None,
            "qualifiers": None,
            "subpath": "NSData+zlib",
            "type": "cocoapods",
            "version": "7.5.2",
        },
        "input": "pkg:cocoapods/GoogleUtilities@7.5.2#NSData+zlib",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/GoogleUtilities@7.5.2#NSData%2Bzlib",
        "input": "pkg:cocoapods/GoogleUtilities@7.5.2#NSData+zlib",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cocoapods",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cocoapods/GoogleUtilities@7.5.2#NSData%2Bzlib",
        "input": {
            "name": "GoogleUtilities",
            "namespace": None,
            "qualifiers": None,
            "subpath": "NSData+zlib",
            "type": "cocoapods",
            "version": "7.5.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "debian can use qualifiers. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "input": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "debian can use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": "debian",
            "qualifiers": {
                "arch": "i386",
                "distro": "jessie",
            },
            "subpath": None,
            "type": "deb",
            "version": "7.50.3-1",
        },
        "input": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "debian can use qualifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "input": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "debian can use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "input": {
            "name": "curl",
            "namespace": "debian",
            "qualifiers": {
                "arch": "i386",
                "distro": "jessie",
            },
            "subpath": None,
            "type": "deb",
            "version": "7.50.3-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": "debian",
            "qualifiers": {
                "arch": "i386",
                "distro": "jessie",
            },
            "subpath": None,
            "type": "deb",
            "version": "7.50.3-1",
        },
        "input": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "input": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
        "input": {
            "name": "curl",
            "namespace": "debian",
            "qualifiers": {
                "arch": "i386",
                "distro": "jessie",
            },
            "subpath": None,
            "type": "deb",
            "version": "7.50.3-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "dpkg",
            "namespace": "debian",
            "qualifiers": {
                "arch": "amd64",
                "distro": "stretch",
            },
            "subpath": None,
            "type": "deb",
            "version": "1.19.0.4",
        },
        "input": "pkg:deb/debian/dpkg@1.19.0.4?arch=amd64&distro=stretch",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/dpkg@1.19.0.4?arch=amd64&distro=stretch",
        "input": "pkg:deb/debian/dpkg@1.19.0.4?arch=amd64&distro=stretch",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/dpkg@1.19.0.4?arch=amd64&distro=stretch",
        "input": {
            "name": "dpkg",
            "namespace": "debian",
            "qualifiers": {
                "arch": "amd64",
                "distro": "stretch",
            },
            "subpath": None,
            "type": "deb",
            "version": "1.19.0.4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "dpkg",
            "namespace": "ubuntu",
            "qualifiers": {
                "arch": "amd64",
            },
            "subpath": None,
            "type": "deb",
            "version": "1.19.0.4",
        },
        "input": "pkg:deb/ubuntu/dpkg@1.19.0.4?arch=amd64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/ubuntu/dpkg@1.19.0.4?arch=amd64",
        "input": "pkg:deb/ubuntu/dpkg@1.19.0.4?arch=amd64",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/ubuntu/dpkg@1.19.0.4?arch=amd64",
        "input": {
            "name": "dpkg",
            "namespace": "ubuntu",
            "qualifiers": {
                "arch": "amd64",
            },
            "subpath": None,
            "type": "deb",
            "version": "1.19.0.4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "attr",
            "namespace": "debian",
            "qualifiers": {
                "arch": "source",
            },
            "subpath": None,
            "type": "deb",
            "version": "1:2.4.47-2",
        },
        "input": "pkg:deb/debian/attr@1:2.4.47-2?arch=source",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/attr@1:2.4.47-2?arch=source",
        "input": "pkg:deb/debian/attr@1:2.4.47-2?arch=source",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/attr@1:2.4.47-2?arch=source",
        "input": {
            "name": "attr",
            "namespace": "debian",
            "qualifiers": {
                "arch": "source",
            },
            "subpath": None,
            "type": "deb",
            "version": "1:2.4.47-2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "attr",
            "namespace": "debian",
            "qualifiers": {
                "arch": "amd64",
            },
            "subpath": None,
            "type": "deb",
            "version": "1:2.4.47-2+b1",
        },
        "input": "pkg:deb/debian/attr@1:2.4.47-2%2Bb1?arch=amd64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/attr@1:2.4.47-2%2Bb1?arch=amd64",
        "input": "pkg:deb/debian/attr@1:2.4.47-2%2Bb1?arch=amd64",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: deb",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:deb/debian/attr@1:2.4.47-2%2Bb1?arch=amd64",
        "input": {
            "name": "attr",
            "namespace": "debian",
            "qualifiers": {
                "arch": "amd64",
            },
            "subpath": None,
            "type": "deb",
            "version": "1:2.4.47-2+b1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rand",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "0.7.2",
        },
        "input": "pkg:cargo/rand@0.7.2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/rand@0.7.2",
        "input": "pkg:cargo/rand@0.7.2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/rand@0.7.2",
        "input": {
            "name": "rand",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "0.7.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "clap",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "2.33.0",
        },
        "input": "pkg:cargo/clap@2.33.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/clap@2.33.0",
        "input": "pkg:cargo/clap@2.33.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/clap@2.33.0",
        "input": {
            "name": "clap",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "2.33.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "structopt",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "0.3.11",
        },
        "input": "pkg:cargo/structopt@0.3.11",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/structopt@0.3.11",
        "input": "pkg:cargo/structopt@0.3.11",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cargo",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cargo/structopt@0.3.11",
        "input": {
            "name": "structopt",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cargo",
            "version": "0.3.11",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid packagist purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/guzzlehttp/promises@2.0.2",
        "input": "pkg:composer/guzzlehttp/promises@2.0.2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid packagist purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "promises",
            "namespace": "guzzlehttp",
            "qualifiers": None,
            "subpath": None,
            "type": "composer",
            "version": "2.0.2",
        },
        "input": "pkg:composer/guzzlehttp/promises@2.0.2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "composer names are not case sensitive. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/laravel/laravel@5.5.0",
        "input": "pkg:composer/Laravel/Laravel@5.5.0",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "composer names are not case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "laravel",
            "namespace": "laravel",
            "qualifiers": None,
            "subpath": None,
            "type": "composer",
            "version": "5.5.0",
        },
        "input": "pkg:composer/Laravel/Laravel@5.5.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "composer names are not case sensitive. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/laravel/laravel@5.5.0",
        "input": "pkg:composer/laravel/laravel@5.5.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "composer names are not case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/laravel/laravel@5.5.0",
        "input": {
            "name": "laravel",
            "namespace": "laravel",
            "qualifiers": None,
            "subpath": None,
            "type": "composer",
            "version": "5.5.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: composer",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "laravel",
            "namespace": "laravel",
            "qualifiers": None,
            "subpath": None,
            "type": "composer",
            "version": "5.5.0",
        },
        "input": "pkg:composer/laravel/laravel@5.5.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: composer",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/laravel/laravel@5.5.0",
        "input": "pkg:composer/laravel/laravel@5.5.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: composer",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:composer/laravel/laravel@5.5.0",
        "input": {
            "name": "laravel",
            "namespace": "laravel",
            "qualifiers": None,
            "subpath": None,
            "type": "composer",
            "version": "5.5.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "characters",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pub",
            "version": "1.2.0",
        },
        "input": "pkg:pub/characters@1.2.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pub/characters@1.2.0",
        "input": "pkg:pub/characters@1.2.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pub/characters@1.2.0",
        "input": {
            "name": "characters",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pub",
            "version": "1.2.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "flutter",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pub",
            "version": "0.0.0",
        },
        "input": "pkg:pub/flutter@0.0.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pub/flutter@0.0.0",
        "input": "pkg:pub/flutter@0.0.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pub",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pub/flutter@0.0.0",
        "input": {
            "name": "flutter",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pub",
            "version": "0.0.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "MLflow model tracked in Azure Databricks (case insensitive). Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/creditfraud@3?repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow",
        "input": "pkg:mlflow/CreditFraud@3?repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model tracked in Azure Databricks (case insensitive)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "creditfraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "input": "pkg:mlflow/CreditFraud@3?repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "MLflow model tracked in Azure Databricks (case insensitive). Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/creditfraud@3?repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow",
        "input": "pkg:mlflow/creditfraud@3?repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model tracked in Azure Databricks (case insensitive)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/creditfraud@3?repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow",
        "input": {
            "name": "creditfraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "MLflow model tracked in Azure ML (case sensitive). Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/CreditFraud@3?repository_url=https:%2F%2Fwestus2.api.azureml.ms%2Fmlflow%2Fv1.0%2Fsubscriptions%2Fa50f2011-fab8-4164-af23-c62881ef8c95%2FresourceGroups%2FTestResourceGroup%2Fproviders%2FMicrosoft.MachineLearningServices%2Fworkspaces%2FTestWorkspace",
        "input": "pkg:mlflow/CreditFraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model tracked in Azure ML (case sensitive)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "CreditFraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "input": "pkg:mlflow/CreditFraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "MLflow model tracked in Azure ML (case sensitive). Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/CreditFraud@3?repository_url=https:%2F%2Fwestus2.api.azureml.ms%2Fmlflow%2Fv1.0%2Fsubscriptions%2Fa50f2011-fab8-4164-af23-c62881ef8c95%2FresourceGroups%2FTestResourceGroup%2Fproviders%2FMicrosoft.MachineLearningServices%2Fworkspaces%2FTestWorkspace",
        "input": "pkg:mlflow/CreditFraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model tracked in Azure ML (case sensitive)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/CreditFraud@3?repository_url=https:%2F%2Fwestus2.api.azureml.ms%2Fmlflow%2Fv1.0%2Fsubscriptions%2Fa50f2011-fab8-4164-af23-c62881ef8c95%2FresourceGroups%2FTestResourceGroup%2Fproviders%2FMicrosoft.MachineLearningServices%2Fworkspaces%2FTestWorkspace",
        "input": {
            "name": "CreditFraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "MLflow model with unique identifiers. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "input": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model with unique identifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "trafficsigns",
            "namespace": None,
            "qualifiers": {
                "model_uuid": "36233173b22f4c89b451f1228d700d49",
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
                "run_id": "410a3121-2709-4f88-98dd-dba0ef056b0a",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "10",
        },
        "input": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "MLflow model with unique identifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "input": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "MLflow model with unique identifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "input": {
            "name": "trafficsigns",
            "namespace": None,
            "qualifiers": {
                "model_uuid": "36233173b22f4c89b451f1228d700d49",
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
                "run_id": "410a3121-2709-4f88-98dd-dba0ef056b0a",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "creditfraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "input": "pkg:mlflow/creditfraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/creditfraud@3?repository_url=https:%2F%2Fwestus2.api.azureml.ms%2Fmlflow%2Fv1.0%2Fsubscriptions%2Fa50f2011-fab8-4164-af23-c62881ef8c95%2FresourceGroups%2FTestResourceGroup%2Fproviders%2FMicrosoft.MachineLearningServices%2Fworkspaces%2FTestWorkspace",
        "input": "pkg:mlflow/creditfraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/creditfraud@3?repository_url=https:%2F%2Fwestus2.api.azureml.ms%2Fmlflow%2Fv1.0%2Fsubscriptions%2Fa50f2011-fab8-4164-af23-c62881ef8c95%2FresourceGroups%2FTestResourceGroup%2Fproviders%2FMicrosoft.MachineLearningServices%2Fworkspaces%2FTestWorkspace",
        "input": {
            "name": "creditfraud",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "trafficsigns",
            "namespace": None,
            "qualifiers": {
                "model_uuid": "36233173b22f4c89b451f1228d700d49",
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
                "run_id": "410a3121-2709-4f88-98dd-dba0ef056b0a",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "10",
        },
        "input": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "input": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: mlflow",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&repository_url=https:%2F%2Fadb-5245952564735461.0.azuredatabricks.net%2Fapi%2F2.0%2Fmlflow&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a",
        "input": {
            "name": "trafficsigns",
            "namespace": None,
            "qualifiers": {
                "model_uuid": "36233173b22f4c89b451f1228d700d49",
                "repository_url": "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
                "run_id": "410a3121-2709-4f88-98dd-dba0ef056b0a",
            },
            "subpath": None,
            "type": "mlflow",
            "version": "10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Enterprise+Server",
            "namespace": "Acme/example.com",
            "qualifiers": {
                "tag_id": "75b8c285-fa7b-485b-b199-4745e3004d0d",
            },
            "subpath": None,
            "type": "swid",
            "version": "1.0.0",
        },
        "input": "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Acme/example.com/Enterprise%2BServer@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d",
        "input": "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Acme/example.com/Enterprise%2BServer@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d",
        "input": {
            "name": "Enterprise+Server",
            "namespace": "Acme/example.com",
            "qualifiers": {
                "tag_id": "75b8c285-fa7b-485b-b199-4745e3004d0d",
            },
            "subpath": None,
            "type": "swid",
            "version": "1.0.0",
        },
        "test_group": "advanced",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Fedora",
            "namespace": None,
            "qualifiers": {
                "tag_id": "org.fedoraproject.Fedora-29",
            },
            "subpath": None,
            "type": "swid",
            "version": "29",
        },
        "input": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29",
        "input": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29",
        "input": {
            "name": "Fedora",
            "namespace": None,
            "qualifiers": {
                "tag_id": "org.fedoraproject.Fedora-29",
            },
            "subpath": None,
            "type": "swid",
            "version": "29",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Adobe+InDesign",
            "namespace": "Adobe+Systems+Incorporated",
            "qualifiers": {
                "tag_id": "CreativeCloud-CS6-Win-GM-MUL",
            },
            "subpath": None,
            "type": "swid",
            "version": "CC",
        },
        "input": "pkg:swid/Adobe+Systems+Incorporated/Adobe+InDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Adobe%2BSystems%2BIncorporated/Adobe%2BInDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL",
        "input": "pkg:swid/Adobe+Systems+Incorporated/Adobe+InDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: swid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swid/Adobe%2BSystems%2BIncorporated/Adobe%2BInDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL",
        "input": {
            "name": "Adobe+InDesign",
            "namespace": "Adobe+Systems+Incorporated",
            "qualifiers": {
                "tag_id": "CreativeCloud-CS6-Win-GM-MUL",
            },
            "subpath": None,
            "type": "swid",
            "version": "CC",
        },
        "test_group": "advanced",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "debian",
            "namespace": None,
            "qualifiers": {
                "arch": "amd64",
                "repository_url": "docker.io/library/debian",
                "tag": "latest",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "input": "pkg:oci/debian@sha256%3A244fd47e07d10?repository_url=docker.io/library/debian&arch=amd64&tag=latest",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/debian@sha256:244fd47e07d10?arch=amd64&repository_url=docker.io%2Flibrary%2Fdebian&tag=latest",
        "input": "pkg:oci/debian@sha256%3A244fd47e07d10?repository_url=docker.io/library/debian&arch=amd64&tag=latest",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/debian@sha256:244fd47e07d10?arch=amd64&repository_url=docker.io%2Flibrary%2Fdebian&tag=latest",
        "input": {
            "name": "debian",
            "namespace": None,
            "qualifiers": {
                "arch": "amd64",
                "repository_url": "docker.io/library/debian",
                "tag": "latest",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "debian",
            "namespace": None,
            "qualifiers": {
                "repository_url": "ghcr.io/debian",
                "tag": "bullseye",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "input": "pkg:oci/debian@sha256%3A244fd47e07d10?repository_url=ghcr.io/debian&tag=bullseye",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/debian@sha256:244fd47e07d10?repository_url=ghcr.io%2Fdebian&tag=bullseye",
        "input": "pkg:oci/debian@sha256%3A244fd47e07d10?repository_url=ghcr.io/debian&tag=bullseye",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/debian@sha256:244fd47e07d10?repository_url=ghcr.io%2Fdebian&tag=bullseye",
        "input": {
            "name": "debian",
            "namespace": None,
            "qualifiers": {
                "repository_url": "ghcr.io/debian",
                "tag": "bullseye",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "test_group": "advanced",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "static",
            "namespace": None,
            "qualifiers": {
                "repository_url": "gcr.io/distroless/static",
                "tag": "latest",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "input": "pkg:oci/static@sha256%3A244fd47e07d10?repository_url=gcr.io/distroless/static&tag=latest",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/static@sha256:244fd47e07d10?repository_url=gcr.io%2Fdistroless%2Fstatic&tag=latest",
        "input": "pkg:oci/static@sha256%3A244fd47e07d10?repository_url=gcr.io/distroless/static&tag=latest",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/static@sha256:244fd47e07d10?repository_url=gcr.io%2Fdistroless%2Fstatic&tag=latest",
        "input": {
            "name": "static",
            "namespace": None,
            "qualifiers": {
                "repository_url": "gcr.io/distroless/static",
                "tag": "latest",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "hello-wasm",
            "namespace": None,
            "qualifiers": {
                "tag": "v1",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "input": "pkg:oci/hello-wasm@sha256%3A244fd47e07d10?tag=v1",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/hello-wasm@sha256:244fd47e07d10?tag=v1",
        "input": "pkg:oci/hello-wasm@sha256%3A244fd47e07d10?tag=v1",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: oci",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:oci/hello-wasm@sha256:244fd47e07d10?tag=v1",
        "input": {
            "name": "hello-wasm",
            "namespace": None,
            "qualifiers": {
                "tag": "v1",
            },
            "subpath": None,
            "type": "oci",
            "version": "sha256:244fd47e07d10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "npm can be scoped. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40angular/animation@12.3.1",
        "input": "pkg:npm/%40angular/animation@12.3.1",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "npm can be scoped",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "animation",
            "namespace": "@angular",
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "input": "pkg:npm/%40angular/animation@12.3.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "npm can be scoped. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40angular/animation@12.3.1",
        "input": "pkg:npm/%40angular/animation@12.3.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "npm can be scoped",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40angular/animation@12.3.1",
        "input": {
            "name": "animation",
            "namespace": "@angular",
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "foobar",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "input": "pkg:npm/foobar@12.3.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/foobar@12.3.1",
        "input": "pkg:npm/foobar@12.3.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/foobar@12.3.1",
        "input": {
            "name": "foobar",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "animation",
            "namespace": "@angular",
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "input": "pkg:npm/%40angular/animation@12.3.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40angular/animation@12.3.1",
        "input": "pkg:npm/%40angular/animation@12.3.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40angular/animation@12.3.1",
        "input": {
            "name": "animation",
            "namespace": "@angular",
            "qualifiers": None,
            "subpath": None,
            "type": "npm",
            "version": "12.3.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "mypackage",
            "namespace": None,
            "qualifiers": {
                "vcs_url": "git://host.com/path/to/repo.git@4345abcd34343",
            },
            "subpath": None,
            "type": "npm",
            "version": "12.4.5",
        },
        "input": "pkg:npm/mypackage@12.4.5?vcs_url=git://host.com/path/to/repo.git%404345abcd34343",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/mypackage@12.4.5?vcs_url=git:%2F%2Fhost.com%2Fpath%2Fto%2Frepo.git%404345abcd34343",
        "input": "pkg:npm/mypackage@12.4.5?vcs_url=git://host.com/path/to/repo.git%404345abcd34343",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for PURL type: npm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/mypackage@12.4.5?vcs_url=git:%2F%2Fhost.com%2Fpath%2Fto%2Frepo.git%404345abcd34343",
        "input": {
            "name": "mypackage",
            "namespace": None,
            "qualifiers": {
                "vcs_url": "git://host.com/path/to/repo.git@4345abcd34343",
            },
            "subpath": None,
            "type": "npm",
            "version": "12.4.5",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid npm purl without version and with subpath, scope unencoded",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/%40babel/core#googleapis/api/annotations",
        "input": "pkg:npm/@babel/core#/googleapis/api/annotations/",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid npm purl without version and with subpath, scope unencoded",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "core",
            "namespace": "@babel",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "npm",
            "version": None,
        },
        "input": "pkg:npm/@babel/core#/googleapis/api/annotations/",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "valid npm purl without version and with subpath, scope unencoded",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "core",
            "namespace": "@babel",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "npm",
            "version": None,
        },
        "input": "pkg:npm/%40babel/core#/googleapis/api/annotations/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid npm purl without namespace and with subpath",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:npm/core@2.0.1#googleapis/api/annotations",
        "input": "pkg:npm/core@2.0.1#/googleapis/api/annotations/",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Parse test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "generic",
            "version": "1.1.10g",
        },
        "input": "pkg:generic/openssl@1.1.10g",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/openssl@1.1.10g",
        "input": "pkg:generic/openssl@1.1.10g",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/openssl@1.1.10g",
        "input": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "generic",
            "version": "1.1.10g",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": {
                "checksum": "sha256:de4d501267da",
                "download_url": "https://openssl.org/source/openssl-1.1.0g.tar.gz",
            },
            "subpath": None,
            "type": "generic",
            "version": "1.1.10g",
        },
        "input": "pkg:generic/openssl@1.1.10g?download_url=https://openssl.org/source/openssl-1.1.0g.tar.gz&checksum=sha256:de4d501267da",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/openssl@1.1.10g?checksum=sha256:de4d501267da&download_url=https:%2F%2Fopenssl.org%2Fsource%2Fopenssl-1.1.0g.tar.gz",
        "input": "pkg:generic/openssl@1.1.10g?download_url=https://openssl.org/source/openssl-1.1.0g.tar.gz&checksum=sha256:de4d501267da",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/openssl@1.1.10g?checksum=sha256:de4d501267da&download_url=https:%2F%2Fopenssl.org%2Fsource%2Fopenssl-1.1.0g.tar.gz",
        "input": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": {
                "checksum": "sha256:de4d501267da",
                "download_url": "https://openssl.org/source/openssl-1.1.0g.tar.gz",
            },
            "subpath": None,
            "type": "generic",
            "version": "1.1.10g",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "bitwarderl",
            "namespace": None,
            "qualifiers": {
                "vcs_url": "git+https://git.fsfe.org/dxtr/bitwarderl@cc55108da32",
            },
            "subpath": None,
            "type": "generic",
            "version": None,
        },
        "input": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps://git.fsfe.org/dxtr/bitwarderl%40cc55108da32",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps:%2F%2Fgit.fsfe.org%2Fdxtr%2Fbitwarderl%40cc55108da32",
        "input": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps://git.fsfe.org/dxtr/bitwarderl%40cc55108da32",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: generic",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps:%2F%2Fgit.fsfe.org%2Fdxtr%2Fbitwarderl%40cc55108da32",
        "input": {
            "name": "bitwarderl",
            "namespace": None,
            "qualifiers": {
                "vcs_url": "git+https://git.fsfe.org/dxtr/bitwarderl@cc55108da32",
            },
            "subpath": None,
            "type": "generic",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "rpm often use qualifiers. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "input": "pkg:Rpm/fedora/curl@7.50.3-1.fc25?Arch=i386&Distro=fedora-25",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "rpm often use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i386",
                "distro": "fedora-25",
            },
            "subpath": None,
            "type": "rpm",
            "version": "7.50.3-1.fc25",
        },
        "input": "pkg:Rpm/fedora/curl@7.50.3-1.fc25?Arch=i386&Distro=fedora-25",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "rpm often use qualifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "input": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "rpm often use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "input": {
            "name": "curl",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i386",
                "distro": "fedora-25",
            },
            "subpath": None,
            "type": "rpm",
            "version": "7.50.3-1.fc25",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i386",
                "distro": "fedora-25",
            },
            "subpath": None,
            "type": "rpm",
            "version": "7.50.3-1.fc25",
        },
        "input": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "input": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
        "input": {
            "name": "curl",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i386",
                "distro": "fedora-25",
            },
            "subpath": None,
            "type": "rpm",
            "version": "7.50.3-1.fc25",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "centerim",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i686",
                "distro": "fedora-25",
                "epoch": "1",
            },
            "subpath": None,
            "type": "rpm",
            "version": "4.22.10-1.el6",
        },
        "input": "pkg:rpm/fedora/centerim@4.22.10-1.el6?arch=i686&epoch=1&distro=fedora-25",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/centerim@4.22.10-1.el6?arch=i686&distro=fedora-25&epoch=1",
        "input": "pkg:rpm/fedora/centerim@4.22.10-1.el6?arch=i686&epoch=1&distro=fedora-25",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: rpm",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:rpm/fedora/centerim@4.22.10-1.el6?arch=i686&distro=fedora-25&epoch=1",
        "input": {
            "name": "centerim",
            "namespace": "fedora",
            "qualifiers": {
                "arch": "i686",
                "distro": "fedora-25",
                "epoch": "1",
            },
            "subpath": None,
            "type": "rpm",
            "version": "4.22.10-1.el6",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": "alpine",
            "qualifiers": {
                "arch": "x86",
            },
            "subpath": None,
            "type": "apk",
            "version": "7.83.0-r0",
        },
        "input": "pkg:apk/alpine/curl@7.83.0-r0?arch=x86",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:apk/alpine/curl@7.83.0-r0?arch=x86",
        "input": "pkg:apk/alpine/curl@7.83.0-r0?arch=x86",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:apk/alpine/curl@7.83.0-r0?arch=x86",
        "input": {
            "name": "curl",
            "namespace": "alpine",
            "qualifiers": {
                "arch": "x86",
            },
            "subpath": None,
            "type": "apk",
            "version": "7.83.0-r0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "apk",
            "namespace": "alpine",
            "qualifiers": {
                "arch": "x86",
            },
            "subpath": None,
            "type": "apk",
            "version": "2.12.9-r3",
        },
        "input": "pkg:apk/alpine/apk@2.12.9-r3?arch=x86",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:apk/alpine/apk@2.12.9-r3?arch=x86",
        "input": "pkg:apk/alpine/apk@2.12.9-r3?arch=x86",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: apk",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:apk/alpine/apk@2.12.9-r3?arch=x86",
        "input": {
            "name": "apk",
            "namespace": "alpine",
            "qualifiers": {
                "arch": "x86",
            },
            "subpath": None,
            "type": "apk",
            "version": "2.12.9-r3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid conan purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/cctz@2.3",
        "input": "pkg:conan/cctz@2.3",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conan purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "cctz",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "conan",
            "version": "2.3",
        },
        "input": "pkg:conan/cctz@2.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid conan purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/cctz@2.3",
        "input": "pkg:conan/cctz@2.3",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conan purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/cctz@2.3",
        "input": {
            "name": "cctz",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "conan",
            "version": "2.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid conan purl with namespace and qualifier channel. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "input": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conan purl with namespace and qualifier channel",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "cctz",
            "namespace": "bincrafters",
            "qualifiers": {
                "channel": "stable",
            },
            "subpath": None,
            "type": "conan",
            "version": "2.3",
        },
        "input": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid conan purl with namespace and qualifier channel. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "input": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conan purl with namespace and qualifier channel",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/bincrafters/cctz@2.3?channel=stable",
        "input": {
            "name": "cctz",
            "namespace": "bincrafters",
            "qualifiers": {
                "channel": "stable",
            },
            "subpath": None,
            "type": "conan",
            "version": "2.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "input": "pkg:conan/openssl@3.0.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl@3.0.3",
        "input": "pkg:conan/openssl@3.0.3",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl@3.0.3",
        "input": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "openssl",
            "namespace": "openssl.org",
            "qualifiers": {
                "channel": "stable",
                "user": "bincrafters",
            },
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "input": "pkg:conan/openssl.org/openssl@3.0.3?user=bincrafters&channel=stable",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl.org/openssl@3.0.3?channel=stable&user=bincrafters",
        "input": "pkg:conan/openssl.org/openssl@3.0.3?user=bincrafters&channel=stable",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl.org/openssl@3.0.3?channel=stable&user=bincrafters",
        "input": {
            "name": "openssl",
            "namespace": "openssl.org",
            "qualifiers": {
                "channel": "stable",
                "user": "bincrafters",
            },
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "openssl",
            "namespace": "openssl.org",
            "qualifiers": {
                "arch": "x86_64",
                "build_type": "Debug",
                "compiler": "Visual Studio",
                "compiler.runtime": "MDd",
                "compiler.version": "16",
                "os": "Windows",
                "prev": "b429db8a0e324114c25ec387bfd8281f330d7c5c",
                "rrev": "93a82349c31917d2d674d22065c7a9ef9f380c8e",
                "shared": "True",
            },
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "input": "pkg:conan/openssl.org/openssl@3.0.3?arch=x86_64&build_type=Debug&compiler=Visual%20Studio&compiler.runtime=MDd&compiler.version=16&os=Windows&shared=True&rrev=93a82349c31917d2d674d22065c7a9ef9f380c8e&prev=b429db8a0e324114c25ec387bfd8281f330d7c5c",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl.org/openssl@3.0.3?arch=x86_64&build_type=Debug&compiler=Visual%20Studio&compiler.runtime=MDd&compiler.version=16&os=Windows&prev=b429db8a0e324114c25ec387bfd8281f330d7c5c&rrev=93a82349c31917d2d674d22065c7a9ef9f380c8e&shared=True",
        "input": "pkg:conan/openssl.org/openssl@3.0.3?arch=x86_64&build_type=Debug&compiler=Visual%20Studio&compiler.runtime=MDd&compiler.version=16&os=Windows&shared=True&rrev=93a82349c31917d2d674d22065c7a9ef9f380c8e&prev=b429db8a0e324114c25ec387bfd8281f330d7c5c",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: conan",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conan/openssl.org/openssl@3.0.3?arch=x86_64&build_type=Debug&compiler=Visual%20Studio&compiler.runtime=MDd&compiler.version=16&os=Windows&prev=b429db8a0e324114c25ec387bfd8281f330d7c5c&rrev=93a82349c31917d2d674d22065c7a9ef9f380c8e&shared=True",
        "input": {
            "name": "openssl",
            "namespace": "openssl.org",
            "qualifiers": {
                "arch": "x86_64",
                "build_type": "Debug",
                "compiler": "Visual Studio",
                "compiler.runtime": "MDd",
                "compiler.version": "16",
                "os": "Windows",
                "prev": "b429db8a0e324114c25ec387bfd8281f330d7c5c",
                "rrev": "93a82349c31917d2d674d22065c7a9ef9f380c8e",
                "shared": "True",
            },
            "subpath": None,
            "type": "conan",
            "version": "3.0.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "luasocket",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "luarocks",
            "version": "3.1.0-1",
        },
        "input": "pkg:luarocks/luasocket@3.1.0-1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/luasocket@3.1.0-1",
        "input": "pkg:luarocks/luasocket@3.1.0-1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/luasocket@3.1.0-1",
        "input": {
            "name": "luasocket",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "luarocks",
            "version": "3.1.0-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "luafilesystem",
            "namespace": "hisham",
            "qualifiers": None,
            "subpath": None,
            "type": "luarocks",
            "version": "1.8.0-1",
        },
        "input": "pkg:luarocks/hisham/luafilesystem@1.8.0-1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/hisham/luafilesystem@1.8.0-1",
        "input": "pkg:luarocks/hisham/luafilesystem@1.8.0-1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/hisham/luafilesystem@1.8.0-1",
        "input": {
            "name": "luafilesystem",
            "namespace": "hisham",
            "qualifiers": None,
            "subpath": None,
            "type": "luarocks",
            "version": "1.8.0-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "packagename",
            "namespace": "username",
            "qualifiers": {
                "repository_url": "https://example.com/private_rocks_server/",
            },
            "subpath": None,
            "type": "luarocks",
            "version": "0.1.0-1",
        },
        "input": "pkg:luarocks/username/packagename@0.1.0-1?repository_url=https://example.com/private_rocks_server/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/username/packagename@0.1.0-1?repository_url=https:%2F%2Fexample.com%2Fprivate_rocks_server%2F",
        "input": "pkg:luarocks/username/packagename@0.1.0-1?repository_url=https://example.com/private_rocks_server/",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: luarocks",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:luarocks/username/packagename@0.1.0-1?repository_url=https:%2F%2Fexample.com%2Fprivate_rocks_server%2F",
        "input": {
            "name": "packagename",
            "namespace": "username",
            "qualifiers": {
                "repository_url": "https://example.com/private_rocks_server/",
            },
            "subpath": None,
            "type": "luarocks",
            "version": "0.1.0-1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for basic VS Code Extension PURL with version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "java",
            "namespace": "redhat",
            "qualifiers": None,
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "input": "pkg:vscode-extension/redhat/java@1.46.2025091308",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for basic VS Code Extension PURL with version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/redhat/java@1.46.2025091308",
        "input": "pkg:vscode-extension/redhat/java@1.46.2025091308",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for basic VS Code Extension PURL with version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/redhat/java@1.46.2025091308",
        "input": {
            "name": "java",
            "namespace": "redhat",
            "qualifiers": None,
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for VS Code Extension PURL with platform qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "java",
            "namespace": "redhat",
            "qualifiers": {
                "platform": "linux-x64",
            },
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "input": "pkg:vscode-extension/redhat/java@1.46.2025091308?platform=linux-x64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for VS Code Extension PURL with platform qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/redhat/java@1.46.2025091308?platform=linux-x64",
        "input": "pkg:vscode-extension/redhat/java@1.46.2025091308?platform=linux-x64",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for VS Code Extension PURL with platform qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/redhat/java@1.46.2025091308?platform=linux-x64",
        "input": {
            "name": "java",
            "namespace": "redhat",
            "qualifiers": {
                "platform": "linux-x64",
            },
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for VS Code Extension PURL without version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "python",
            "namespace": "ms-python",
            "qualifiers": None,
            "subpath": None,
            "type": "vscode-extension",
            "version": None,
        },
        "input": "pkg:vscode-extension/ms-python/python",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for VS Code Extension PURL without version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/ms-python/python",
        "input": "pkg:vscode-extension/ms-python/python",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test for VS Code Extension PURL without version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:vscode-extension/microsoft/python",
        "input": {
            "name": "python",
            "namespace": "microsoft",
            "qualifiers": None,
            "subpath": None,
            "type": "vscode-extension",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for VS Code Extension PURL with darwin-arm64 platform",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "python",
            "namespace": "microsoft",
            "qualifiers": {
                "platform": "darwin-arm64",
            },
            "subpath": None,
            "type": "vscode-extension",
            "version": "2024.10.0",
        },
        "input": "pkg:vscode-extension/microsoft/python@2024.10.0?platform=darwin-arm64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Parse test for VS Code Extension PURL with win32-x64 platform",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "go",
            "namespace": "golang",
            "qualifiers": {
                "platform": "win32-x64",
            },
            "subpath": None,
            "type": "vscode-extension",
            "version": "0.39.1",
        },
        "input": "pkg:vscode-extension/golang/go@0.39.1?platform=win32-x64",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Parse test for VS Code Extension PURL without namespace should fail",
        "expected_failure": True,
        "expected_failure_reason": "VS Code Extension PURLs require a namespace (publisher)",
        "expected_output": None,
        "input": "pkg:vscode-extension/java@1.46.2025091308",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Build test for VS Code Extension PURL without namespace should fail",
        "expected_failure": True,
        "expected_failure_reason": "VS Code Extension PURLs require a namespace (publisher)",
        "expected_output": None,
        "input": {
            "name": "java",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for VS Code Extension PURL with platform=universal (default)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "java",
            "namespace": "redhat",
            "qualifiers": {
                "platform": "universal",
            },
            "subpath": None,
            "type": "vscode-extension",
            "version": "1.46.2025091308",
        },
        "input": "pkg:vscode-extension/redhat/java@1.46.2025091308?platform=universal",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "pypi names have special rules and not case sensitive. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django-package@1.11.1.dev1",
        "input": "pkg:PYPI/Django_package@1.11.1.dev1",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "pypi names have special rules and not case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "django-package",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1.dev1",
        },
        "input": "pkg:PYPI/Django_package@1.11.1.dev1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "pypi names have special rules and not case sensitive. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django-package@1.11.1.dev1",
        "input": "pkg:pypi/django-package@1.11.1.dev1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "pypi names have special rules and not case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django-package@1.11.1.dev1",
        "input": {
            "name": "django-package",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1.dev1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "django",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "input": "pkg:pypi/django@1.11.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1",
        "input": "pkg:pypi/django@1.11.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1",
        "input": {
            "name": "django",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "django",
            "namespace": None,
            "qualifiers": {
                "file_name": "Django-1.11.1.tar.gz",
            },
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "input": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1.tar.gz",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1.tar.gz",
        "input": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1.tar.gz",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1.tar.gz",
        "input": {
            "name": "django",
            "namespace": None,
            "qualifiers": {
                "file_name": "Django-1.11.1.tar.gz",
            },
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "django",
            "namespace": None,
            "qualifiers": {
                "file_name": "Django-1.11.1-py2.py3-none-any.whl",
            },
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "input": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1-py2.py3-none-any.whl",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1-py2.py3-none-any.whl",
        "input": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1-py2.py3-none-any.whl",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django@1.11.1?file_name=Django-1.11.1-py2.py3-none-any.whl",
        "input": {
            "name": "django",
            "namespace": None,
            "qualifiers": {
                "file_name": "Django-1.11.1-py2.py3-none-any.whl",
            },
            "subpath": None,
            "type": "pypi",
            "version": "1.11.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "django-allauth",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "12.23",
        },
        "input": "pkg:pypi/django-allauth@12.23",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django-allauth@12.23",
        "input": "pkg:pypi/django-allauth@12.23",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: pypi",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:pypi/django-allauth@12.23",
        "input": {
            "name": "django-allauth",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "pypi",
            "version": "12.23",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid opam purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:opam/conex@1.0.0",
        "input": "pkg:opam/conex@1.0.0",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid opam purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "conex",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "opam",
            "version": "1.0.0",
        },
        "input": "pkg:opam/conex@1.0.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid opam purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:opam/conex@1.0.0",
        "input": "pkg:opam/conex@1.0.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid opam purl (name only)",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:opam/conex",
        "input": {
            "name": "conex",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "opam",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "name is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "opam",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid julia purl for stdlib package with version and uuid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Dates",
            "namespace": None,
            "qualifiers": {
                "uuid": "ade2ca70-3891-5945-98fb-dc099432e06a",
            },
            "subpath": None,
            "type": "julia",
            "version": "1.9.0",
        },
        "input": "pkg:julia/Dates@1.9.0?uuid=ade2ca70-3891-5945-98fb-dc099432e06a",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid julia purl for stdlib package with uuid but no version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Dates",
            "namespace": None,
            "qualifiers": {
                "uuid": "ade2ca70-3891-5945-98fb-dc099432e06a",
            },
            "subpath": None,
            "type": "julia",
            "version": None,
        },
        "input": "pkg:julia/Dates?uuid=ade2ca70-3891-5945-98fb-dc099432e06a",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid julia purl, version and uuid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "AWS",
            "namespace": None,
            "qualifiers": {
                "uuid": "fbe9abb3-538b-5e4e-ba9e-bc94f4f92ebc",
            },
            "subpath": None,
            "type": "julia",
            "version": "1.88.0",
        },
        "input": "pkg:julia/AWS@1.88.0?uuid=fbe9abb3-538b-5e4e-ba9e-bc94f4f92ebc",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid julia purl with both uuid and repository_url qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "RegisterQD",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://github.com/HolyLab/HolyLabRegistry",
                "uuid": "ac24ea0c-1830-11e9-18d4-81f172323054",
            },
            "subpath": None,
            "type": "julia",
            "version": "0.3.1",
        },
        "input": "pkg:julia/RegisterQD@0.3.1?repository_url=https://github.com/HolyLab/HolyLabRegistry&uuid=ac24ea0c-1830-11e9-18d4-81f172323054",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid julia purl build test - stdlib package with version and uuid",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:julia/Dates@1.9.0?uuid=ade2ca70-3891-5945-98fb-dc099432e06a",
        "input": {
            "name": "Dates",
            "namespace": None,
            "qualifiers": {
                "uuid": "ade2ca70-3891-5945-98fb-dc099432e06a",
            },
            "subpath": None,
            "type": "julia",
            "version": "1.9.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid julia purl build test with both qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:julia/RegisterQD@0.3.1?repository_url=https:%2F%2Fgithub.com%2FHolyLab%2FHolyLabRegistry&uuid=ac24ea0c-1830-11e9-18d4-81f172323054",
        "input": {
            "name": "RegisterQD",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://github.com/HolyLab/HolyLabRegistry",
                "uuid": "ac24ea0c-1830-11e9-18d4-81f172323054",
            },
            "subpath": None,
            "type": "julia",
            "version": "0.3.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid julia purl roundtrip test - basic package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:julia/Dates@1.9.0?uuid=ade2ca70-3891-5945-98fb-dc099432e06a",
        "input": "pkg:julia/Dates@1.9.0?uuid=ade2ca70-3891-5945-98fb-dc099432e06a",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid julia purl roundtrip test - multiple qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:julia/RegisterQD@0.3.1?repository_url=https:%2F%2Fgithub.com%2FHolyLab%2FHolyLabRegistry&uuid=ac24ea0c-1830-11e9-18d4-81f172323054",
        "input": "pkg:julia/RegisterQD@0.3.1?repository_url=https://github.com/HolyLab/HolyLabRegistry&uuid=ac24ea0c-1830-11e9-18d4-81f172323054",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "invalid julia purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:julia/@1.9.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid julia purl with only type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:julia",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid julia purl build test - null name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": None,
            "qualifiers": {
                "uuid": "ade2ca70-3891-5945-98fb-dc099432e06a",
            },
            "subpath": None,
            "type": "julia",
            "version": "1.9.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid julia purl build test - empty name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "",
            "namespace": None,
            "qualifiers": {
                "uuid": "ade2ca70-3891-5945-98fb-dc099432e06a",
            },
            "subpath": None,
            "type": "julia",
            "version": "1.9.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid julia purl for package without uuid",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:julia/Dates",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid swift purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "input": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid swift purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Alamofire",
            "namespace": "github.com/Alamofire",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "input": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid swift purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "input": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid swift purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "input": {
            "name": "Alamofire",
            "namespace": "github.com/Alamofire",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid swift purl without namespace",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:swift/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid swift purl without namespace",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:swift/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid swift purl without namespace",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "Alamofire",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid swift purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:swift/github.com/Alamofire/@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid swift purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:swift/github.com/Alamofire/@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid swift purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": "github.com/Alamofire",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Alamofire",
            "namespace": "github.com/Alamofire",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "input": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "input": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/Alamofire/Alamofire@5.4.3",
        "input": {
            "name": "Alamofire",
            "namespace": "github.com/Alamofire",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "5.4.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "RxFlow",
            "namespace": "github.com/RxSwiftCommunity",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "2.12.4",
        },
        "input": "pkg:swift/github.com/RxSwiftCommunity/RxFlow@2.12.4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/RxSwiftCommunity/RxFlow@2.12.4",
        "input": "pkg:swift/github.com/RxSwiftCommunity/RxFlow@2.12.4",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: swift",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:swift/github.com/RxSwiftCommunity/RxFlow@2.12.4",
        "input": {
            "name": "RxFlow",
            "namespace": "github.com/RxSwiftCommunity",
            "qualifiers": None,
            "subpath": None,
            "type": "swift",
            "version": "2.12.4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "docker uses qualifiers and hash image id as versions. Roundtrip an input purl wrongly percent encoded to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/customer/dockerimage@sha256:244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "input": "pkg:docker/customer/dockerimage@sha256%3A244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "docker uses qualifiers and hash image id as versions",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "dockerimage",
            "namespace": "customer",
            "qualifiers": {
                "repository_url": "gcr.io",
            },
            "subpath": None,
            "type": "docker",
            "version": "sha256:244fd47e07d1004f0aed9c",
        },
        "input": "pkg:docker/customer/dockerimage@sha256:244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "docker uses qualifiers and hash image id as versions. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/customer/dockerimage@sha256:244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "input": "pkg:docker/customer/dockerimage@sha256:244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "docker uses qualifiers and hash image id as versions",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/customer/dockerimage@sha256:244fd47e07d1004f0aed9c?repository_url=gcr.io",
        "input": {
            "name": "dockerimage",
            "namespace": "customer",
            "qualifiers": {
                "repository_url": "gcr.io",
            },
            "subpath": None,
            "type": "docker",
            "version": "sha256:244fd47e07d1004f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "cassandra",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "docker",
            "version": "latest",
        },
        "input": "pkg:docker/cassandra@latest",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/cassandra@latest",
        "input": "pkg:docker/cassandra@latest",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/cassandra@latest",
        "input": {
            "name": "cassandra",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "docker",
            "version": "latest",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "debian",
            "namespace": "smartentry",
            "qualifiers": None,
            "subpath": None,
            "type": "docker",
            "version": "dc437cc87d10",
        },
        "input": "pkg:docker/smartentry/debian@dc437cc87d10",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/smartentry/debian@dc437cc87d10",
        "input": "pkg:docker/smartentry/debian@dc437cc87d10",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/smartentry/debian@dc437cc87d10",
        "input": {
            "name": "debian",
            "namespace": "smartentry",
            "qualifiers": None,
            "subpath": None,
            "type": "docker",
            "version": "dc437cc87d10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "dockerimage",
            "namespace": "customer",
            "qualifiers": {
                "repository_url": "gcr.io",
            },
            "subpath": None,
            "type": "docker",
            "version": "sha256:244fd47e07d10",
        },
        "input": "pkg:docker/customer/dockerimage@sha256:244fd47e07d10?repository_url=gcr.io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/customer/dockerimage@sha256:244fd47e07d10?repository_url=gcr.io",
        "input": "pkg:docker/customer/dockerimage@sha256:244fd47e07d10?repository_url=gcr.io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: docker",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:docker/customer/dockerimage@sha256:244fd47e07d10?repository_url=gcr.io",
        "input": {
            "name": "dockerimage",
            "namespace": "customer",
            "qualifiers": {
                "repository_url": "gcr.io",
            },
            "subpath": None,
            "type": "docker",
            "version": "sha256:244fd47e07d10",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jason",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hex",
            "version": "1.1.2",
        },
        "input": "pkg:hex/jason@1.1.2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/jason@1.1.2",
        "input": "pkg:hex/jason@1.1.2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/jason@1.1.2",
        "input": {
            "name": "jason",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "hex",
            "version": "1.1.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "foo",
            "namespace": "acme",
            "qualifiers": None,
            "subpath": None,
            "type": "hex",
            "version": "2.3.",
        },
        "input": "pkg:hex/acme/foo@2.3.",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/acme/foo@2.3.",
        "input": "pkg:hex/acme/foo@2.3.",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/acme/foo@2.3.",
        "input": {
            "name": "foo",
            "namespace": "acme",
            "qualifiers": None,
            "subpath": None,
            "type": "hex",
            "version": "2.3.",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "phoenix_html",
            "namespace": None,
            "qualifiers": None,
            "subpath": "priv/static/phoenix_html.js",
            "type": "hex",
            "version": "2.13.3",
        },
        "input": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
        "input": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
        "input": {
            "name": "phoenix_html",
            "namespace": None,
            "qualifiers": None,
            "subpath": "priv/static/phoenix_html.js",
            "type": "hex",
            "version": "2.13.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "bar",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://myrepo.example.com",
            },
            "subpath": None,
            "type": "hex",
            "version": "1.2.3",
        },
        "input": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/bar@1.2.3?repository_url=https:%2F%2Fmyrepo.example.com",
        "input": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: hex",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:hex/bar@1.2.3?repository_url=https:%2F%2Fmyrepo.example.com",
        "input": {
            "name": "bar",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://myrepo.example.com",
            },
            "subpath": None,
            "type": "hex",
            "version": "1.2.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "com.qnx.sdp",
            "namespace": "blackberry",
            "qualifiers": None,
            "subpath": None,
            "type": "qpkg",
            "version": "7.0.0.SGA201702151847",
        },
        "input": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847",
        "input": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847",
        "input": {
            "name": "com.qnx.sdp",
            "namespace": "blackberry",
            "qualifiers": None,
            "subpath": None,
            "type": "qpkg",
            "version": "7.0.0.SGA201702151847",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "com.qnx.qnx710.foo.bar.qux",
            "namespace": "blackberry",
            "qualifiers": None,
            "subpath": None,
            "type": "qpkg",
            "version": "0.0.4.01449T202205040833L",
        },
        "input": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L",
        "input": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: qpkg",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L",
        "input": {
            "name": "com.qnx.qnx710.foo.bar.qux",
            "namespace": "blackberry",
            "qualifiers": None,
            "subpath": None,
            "type": "qpkg",
            "version": "0.0.4.01449T202205040833L",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "github namespace and name should be lowercased. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004f0aed9c",
        "input": "pkg:github/Package-url/purl-Spec@244fd47e07d1004f0aed9c",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "github namespace and name should be lowercased",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": None,
            "type": "github",
            "version": "244fd47e07d1004f0aed9c",
        },
        "input": "pkg:github/Package-url/purl-Spec@244fd47e07d1004f0aed9c",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "github namespace and name should be lowercased. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004f0aed9c",
        "input": "pkg:github/package-url/purl-spec@244fd47e07d1004f0aed9c",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "github namespace and name should be lowercased",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004f0aed9c",
        "input": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": None,
            "type": "github",
            "version": "244fd47e07d1004f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": None,
            "type": "github",
            "version": "244fd47e07d1004",
        },
        "input": "pkg:github/package-url/purl-spec@244fd47e07d1004",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004",
        "input": "pkg:github/package-url/purl-spec@244fd47e07d1004",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004",
        "input": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": None,
            "type": "github",
            "version": "244fd47e07d1004",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": "everybody/loves/dogs",
            "type": "github",
            "version": "244fd47e07d1004",
        },
        "input": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
        "input": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: github",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
        "input": {
            "name": "purl-spec",
            "namespace": "package-url",
            "qualifiers": None,
            "subpath": "everybody/loves/dogs",
            "type": "github",
            "version": "244fd47e07d1004",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid cran purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/A3@0.9.1",
        "input": "pkg:cran/A3@0.9.1",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid cran purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "A3",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "0.9.1",
        },
        "input": "pkg:cran/A3@0.9.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid cran purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/A3@0.9.1",
        "input": "pkg:cran/A3@0.9.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid cran purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/A3@0.9.1",
        "input": {
            "name": "A3",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "0.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid cran purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:cran/@0.9.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid cran purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:cran/@0.9.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "invalid cran purl without name",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "0.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "A3",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "1.0.0",
        },
        "input": "pkg:cran/A3@1.0.0",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/A3@1.0.0",
        "input": "pkg:cran/A3@1.0.0",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/A3@1.0.0",
        "input": {
            "name": "A3",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "1.0.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rJava",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "1.0-4",
        },
        "input": "pkg:cran/rJava@1.0-4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/rJava@1.0-4",
        "input": "pkg:cran/rJava@1.0-4",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/rJava@1.0-4",
        "input": {
            "name": "rJava",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "1.0-4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "caret",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "6.0-88",
        },
        "input": "pkg:cran/caret@6.0-88",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/caret@6.0-88",
        "input": "pkg:cran/caret@6.0-88",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: cran",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:cran/caret@6.0-88",
        "input": {
            "name": "caret",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "cran",
            "version": "6.0-88",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module with default registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@7.8.0?repository_url=https:%2F%2Fbcr.bazel.build%2F",
        "input": "pkg:bazel/rules_java@7.8.0?repository_url=https://bcr.bazel.build/",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with default registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://bcr.bazel.build/",
            },
            "subpath": None,
            "type": "bazel",
            "version": "7.8.0",
        },
        "input": "pkg:bazel/rules_java@7.8.0?repository_url=https://bcr.bazel.build/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with default registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@7.8.0",
        "input": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "bazel",
            "version": "7.8.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module with custom registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@7.8.0?repository_url=https:%2F%2Fexample.org%2Fbazel-registry%2F",
        "input": "pkg:bazel/rules_java@7.8.0?repository_url=https://example.org/bazel-registry/",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with custom registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://example.org/bazel-registry/",
            },
            "subpath": None,
            "type": "bazel",
            "version": "7.8.0",
        },
        "input": "pkg:bazel/rules_java@7.8.0?repository_url=https://example.org/bazel-registry/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with custom registry",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@7.8.0?repository_url=https:%2F%2Fexample.org%2Fbazel-registry",
        "input": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": {
                "repository_url": "https://example.org/bazel-registry",
            },
            "subpath": None,
            "type": "bazel",
            "version": "7.8.0",
        },
        "test_group": "advanced",
        "test_type": "build",
    },
    {
        "description": "bazel module with relaxed semver version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/curl@8.8.0.bcr.1",
        "input": "pkg:bazel/curl@8.8.0.bcr.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with relaxed semver version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "curl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "bazel",
            "version": "8.8.0.bcr.1",
        },
        "input": "pkg:bazel/curl@8.8.0.bcr.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with relaxed semver version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/curl@8.8.0.bcr.1",
        "input": {
            "name": "curl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "bazel",
            "version": "8.8.0.bcr.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module names are actually all lowercased, but this is not enforced by the PURL type spec for reasons",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/Curl@8.8.0.bcr.1",
        "input": "pkg:bazel/Curl@8.8.0.bcr.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module names are actually all lowercased, but this is not enforced by the PURL type spec for reasons",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "Curl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "bazel",
            "version": "8.8.0.bcr.1",
        },
        "input": "pkg:bazel/Curl@8.8.0.bcr.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module names are actually all lowercased, but this is not enforced by the PURL type spec for reasons",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/Curl@8.8.0.bcr.1",
        "input": {
            "name": "Curl",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "bazel",
            "version": "8.8.0.bcr.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module with multi-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@8.5.0#java/runfiles",
        "input": "pkg:bazel/rules_java@8.5.0#java/runfiles",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with multi-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": None,
            "subpath": "java/runfiles",
            "type": "bazel",
            "version": "8.5.0",
        },
        "input": "pkg:bazel/rules_java@8.5.0#java/runfiles",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with multi-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@8.5.0#java/runfiles",
        "input": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": None,
            "subpath": "java/runfiles",
            "type": "bazel",
            "version": "8.5.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module with target reference",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@8.5.0#java/runfiles:runfiles",
        "input": "pkg:bazel/rules_java@8.5.0#java/runfiles:runfiles",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with target reference",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": None,
            "subpath": "java/runfiles:runfiles",
            "type": "bazel",
            "version": "8.5.0",
        },
        "input": "pkg:bazel/rules_java@8.5.0#java/runfiles:runfiles",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with target reference",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_java@8.5.0#java/runfiles:runfiles",
        "input": {
            "name": "rules_java",
            "namespace": None,
            "qualifiers": None,
            "subpath": "java/runfiles:runfiles",
            "type": "bazel",
            "version": "8.5.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bazel module with single-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_go@0.48.0#go",
        "input": "pkg:bazel/rules_go@0.48.0#go",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bazel module with single-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "rules_go",
            "namespace": None,
            "qualifiers": None,
            "subpath": "go",
            "type": "bazel",
            "version": "0.48.0",
        },
        "input": "pkg:bazel/rules_go@0.48.0#go",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bazel module with single-segment package",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bazel/rules_go@0.48.0#go",
        "input": {
            "name": "rules_go",
            "namespace": None,
            "qualifiers": None,
            "subpath": "go",
            "type": "bazel",
            "version": "0.48.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "basic yocto recipe test",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "glibc",
            "namespace": "core",
            "qualifiers": {
                "layer_version": "kirkstone",
                "repository_url": "https://git.openembedded.org/openembedded-core",
            },
            "subpath": None,
            "type": "yocto",
            "version": "2.35",
        },
        "input": "pkg:yocto/core/glibc@2.35?repository_url=https:%2F%2Fgit.openembedded.org%2Fopenembedded-core&layer_version=kirkstone",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid go purl without version and with subpath. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "input": "pkg:GOLANG/google.golang.org/genproto#/googleapis/api/annotations/",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid go purl without version and with subpath",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": None,
        },
        "input": "pkg:GOLANG/google.golang.org/genproto#/googleapis/api/annotations/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid go purl without version and with subpath. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "input": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid go purl without version and with subpath",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "input": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid go purl with version and subpath. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto@abcdedf#googleapis/api/annotations",
        "input": "pkg:GOLANG/google.golang.org/genproto@abcdedf#/googleapis/api/annotations/",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid go purl with version and subpath",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": "abcdedf",
        },
        "input": "pkg:GOLANG/google.golang.org/genproto@abcdedf#/googleapis/api/annotations/",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid go purl with version and subpath. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto@abcdedf#googleapis/api/annotations",
        "input": "pkg:golang/google.golang.org/genproto@abcdedf#googleapis/api/annotations",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid go purl with version and subpath",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto@abcdedf#googleapis/api/annotations",
        "input": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": "abcdedf",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "context",
            "namespace": "github.com/gorilla",
            "qualifiers": None,
            "subpath": None,
            "type": "golang",
            "version": "234fd47e07d1004f0aed9c",
        },
        "input": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c",
        "input": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c",
        "input": {
            "name": "context",
            "namespace": "github.com/gorilla",
            "qualifiers": None,
            "subpath": None,
            "type": "golang",
            "version": "234fd47e07d1004f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": None,
        },
        "input": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "input": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/google.golang.org/genproto#googleapis/api/annotations",
        "input": {
            "name": "genproto",
            "namespace": "google.golang.org",
            "qualifiers": None,
            "subpath": "googleapis/api/annotations",
            "type": "golang",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "context",
            "namespace": "github.com/gorilla",
            "qualifiers": None,
            "subpath": "api",
            "type": "golang",
            "version": "234fd47e07d1004f0aed9c",
        },
        "input": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c#api",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c#api",
        "input": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c#api",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: golang",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:golang/github.com/gorilla/context@234fd47e07d1004f0aed9c#api",
        "input": {
            "name": "context",
            "namespace": "github.com/gorilla",
            "qualifiers": None,
            "subpath": "api",
            "type": "golang",
            "version": "234fd47e07d1004f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "bitbucket namespace and name should be lowercased. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "input": "pkg:bitbucket/birKenfeld/pyGments-main@244fd47e07d1014f0aed9c",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "bitbucket namespace and name should be lowercased",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "pygments-main",
            "namespace": "birkenfeld",
            "qualifiers": None,
            "subpath": None,
            "type": "bitbucket",
            "version": "244fd47e07d1014f0aed9c",
        },
        "input": "pkg:bitbucket/birKenfeld/pyGments-main@244fd47e07d1014f0aed9c",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "bitbucket namespace and name should be lowercased. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "input": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "bitbucket namespace and name should be lowercased",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "input": {
            "name": "pygments-main",
            "namespace": "birkenfeld",
            "qualifiers": None,
            "subpath": None,
            "type": "bitbucket",
            "version": "244fd47e07d1014f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: bitbucket",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "pygments-main",
            "namespace": "birkenfeld",
            "qualifiers": None,
            "subpath": None,
            "type": "bitbucket",
            "version": "244fd47e07d1014f0aed9c",
        },
        "input": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: bitbucket",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "input": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: bitbucket",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitbucket/birkenfeld/pygments-main@244fd47e07d1014f0aed9c",
        "input": {
            "name": "pygments-main",
            "namespace": "birkenfeld",
            "qualifiers": None,
            "subpath": None,
            "type": "bitbucket",
            "version": "244fd47e07d1014f0aed9c",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "asn1",
            "namespace": None,
            "qualifiers": {
                "arch": "amd64",
                "platform": "linux",
                "repository_url": "https://github.com/erlang/otp",
                "vcs_url": "git+https://github.com/erlang/otp.git",
            },
            "subpath": "src/asn1ct.erl",
            "type": "otp",
            "version": "5.4.1",
        },
        "input": "pkg:otp/asn1@5.4.1?arch=amd64&platform=linux&repository_url=https:%2F%2Fgithub.com%2Ferlang%2Fotp&vcs_url=git%2Bhttps:%2F%2Fgithub.com%2Ferlang%2Fotp.git#src/asn1ct.erl",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:otp/asn1@5.4.1?arch=amd64&platform=linux&repository_url=https:%2F%2Fgithub.com%2Ferlang%2Fotp&vcs_url=git%2Bhttps:%2F%2Fgithub.com%2Ferlang%2Fotp.git#src/asn1ct.erl",
        "input": "pkg:otp/asn1@5.4.1?arch=amd64&platform=linux&repository_url=https://github.com/erlang/otp&vcs_url=git%2Bhttps://github.com/erlang/otp.git#src/asn1ct.erl",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:otp/asn1@5.4.1?arch=amd64&platform=linux&repository_url=https:%2F%2Fgithub.com%2Ferlang%2Fotp&vcs_url=git%2Bhttps:%2F%2Fgithub.com%2Ferlang%2Fotp.git#src/asn1ct.erl",
        "input": {
            "name": "asn1",
            "namespace": None,
            "qualifiers": {
                "arch": "amd64",
                "platform": "linux",
                "repository_url": "https://github.com/erlang/otp",
                "vcs_url": "git+https://github.com/erlang/otp.git",
            },
            "subpath": "src/asn1ct.erl",
            "type": "otp",
            "version": "5.4.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "hex",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "otp",
            "version": "2.1.1",
        },
        "input": "pkg:otp/hex@2.1.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:otp/hex@2.1.1",
        "input": "pkg:otp/hex@2.1.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for <class 'type'> PURL",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:otp/hex@2.1.1",
        "input": {
            "name": "hex",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "otp",
            "version": "2.1.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for <class 'type'> PURL",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse an OTP PURL containing a prohibited namespace component",
        "input": "pkg:otp/namespace/hex@2.1.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Build test  for <class 'type'> PURL",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build an OTP PURL containing a prohibited namespace component",
        "input": {
            "name": "hex",
            "namespace": "namespace",
            "qualifiers": None,
            "subpath": None,
            "type": "otp",
            "version": "2.1.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Ruby gems can use qualifiers. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "input": "pkg:gem/jruby-launcher@1.1.2?Platform=java",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Ruby gems can use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jruby-launcher",
            "namespace": None,
            "qualifiers": {
                "platform": "java",
            },
            "subpath": None,
            "type": "gem",
            "version": "1.1.2",
        },
        "input": "pkg:gem/jruby-launcher@1.1.2?Platform=java",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Ruby gems can use qualifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "input": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Ruby gems can use qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "input": {
            "name": "jruby-launcher",
            "namespace": None,
            "qualifiers": {
                "platform": "java",
            },
            "subpath": None,
            "type": "gem",
            "version": "1.1.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "ruby-advisory-db-check",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "gem",
            "version": "0.12.4",
        },
        "input": "pkg:gem/ruby-advisory-db-check@0.12.4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/ruby-advisory-db-check@0.12.4",
        "input": "pkg:gem/ruby-advisory-db-check@0.12.4",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/ruby-advisory-db-check@0.12.4",
        "input": {
            "name": "ruby-advisory-db-check",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "gem",
            "version": "0.12.4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jruby-launcher",
            "namespace": None,
            "qualifiers": {
                "platform": "java",
            },
            "subpath": None,
            "type": "gem",
            "version": "1.1.2",
        },
        "input": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "input": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: gem",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:gem/jruby-launcher@1.1.2?platform=java",
        "input": {
            "name": "jruby-launcher",
            "namespace": None,
            "qualifiers": {
                "platform": "java",
            },
            "subpath": None,
            "type": "gem",
            "version": "1.1.2",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "nuget names are case sensitive. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "input": "pkg:Nuget/EnterpriseLibrary.Common@6.0.1304",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "nuget names are case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "EnterpriseLibrary.Common",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "nuget",
            "version": "6.0.1304",
        },
        "input": "pkg:Nuget/EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "nuget names are case sensitive. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "input": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "nuget names are case sensitive",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "input": {
            "name": "EnterpriseLibrary.Common",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "nuget",
            "version": "6.0.1304",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: nuget",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "EnterpriseLibrary.Common",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "nuget",
            "version": "6.0.1304",
        },
        "input": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: nuget",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "input": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: nuget",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:nuget/EnterpriseLibrary.Common@6.0.1304",
        "input": {
            "name": "EnterpriseLibrary.Common",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "nuget",
            "version": "6.0.1304",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "minimal Hugging Face model. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "input": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "minimal Hugging Face model",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "distilbert-base-uncased",
            "namespace": "distilbert",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "043235d6088ecd3dd5fb5ca3592b6913fd516027",
        },
        "input": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "minimal Hugging Face model. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "input": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "minimal Hugging Face model",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "input": {
            "name": "distilbert-base-uncased",
            "namespace": "distilbert",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "043235d6088ecd3dd5fb5ca3592b6913fd516027",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Hugging Face model with staging endpoint. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https:%2F%2Fhub-ci.huggingface.co",
        "input": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Hugging Face model with staging endpoint",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "deberta-v3-base",
            "namespace": "microsoft",
            "qualifiers": {
                "repository_url": "https://hub-ci.huggingface.co",
            },
            "subpath": None,
            "type": "huggingface",
            "version": "559062ad13d311b87b2c455e67dcd5f1c8f65111",
        },
        "input": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Hugging Face model with staging endpoint. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https:%2F%2Fhub-ci.huggingface.co",
        "input": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Hugging Face model with staging endpoint",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https:%2F%2Fhub-ci.huggingface.co",
        "input": {
            "name": "deberta-v3-base",
            "namespace": "microsoft",
            "qualifiers": {
                "repository_url": "https://hub-ci.huggingface.co",
            },
            "subpath": None,
            "type": "huggingface",
            "version": "559062ad13d311b87b2c455e67dcd5f1c8f65111",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Hugging Face model with various cases. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552ae47f449ab70b684cabcb6603e5e85e",
        "input": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552AE47F449AB70B684CABCB6603E5E85E",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "Hugging Face model with various cases",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "gpt-neo-1.3B",
            "namespace": "EleutherAI",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "797174552ae47f449ab70b684cabcb6603e5e85e",
        },
        "input": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552AE47F449AB70B684CABCB6603E5E85E",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Hugging Face model with various cases. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552ae47f449ab70b684cabcb6603e5e85e",
        "input": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552ae47f449ab70b684cabcb6603e5e85e",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Hugging Face model with various cases",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/EleutherAI/gpt-neo-1.3B@797174552ae47f449ab70b684cabcb6603e5e85e",
        "input": {
            "name": "gpt-neo-1.3B",
            "namespace": "EleutherAI",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "797174552ae47f449ab70b684cabcb6603e5e85e",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "distilbert-base-uncased",
            "namespace": "distilbert",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "043235d6088ecd3dd5fb5ca3592b6913fd516027",
        },
        "input": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "input": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/distilbert/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
        "input": {
            "name": "distilbert-base-uncased",
            "namespace": "distilbert",
            "qualifiers": None,
            "subpath": None,
            "type": "huggingface",
            "version": "043235d6088ecd3dd5fb5ca3592b6913fd516027",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "deberta-v3-base",
            "namespace": "microsoft",
            "qualifiers": {
                "repository_url": "https://hub-ci.huggingface.co",
            },
            "subpath": None,
            "type": "huggingface",
            "version": "559062ad13d311b87b2c455e67dcd5f1c8f65111",
        },
        "input": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https:%2F%2Fhub-ci.huggingface.co",
        "input": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: huggingface",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https:%2F%2Fhub-ci.huggingface.co",
        "input": {
            "name": "deberta-v3-base",
            "namespace": "microsoft",
            "qualifiers": {
                "repository_url": "https://hub-ci.huggingface.co",
            },
            "subpath": None,
            "type": "huggingface",
            "version": "559062ad13d311b87b2c455e67dcd5f1c8f65111",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": None,
        },
        "input": "pkg:bitnami/wordpress?distro=debian-12",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress?distro=debian-12",
        "input": "pkg:bitnami/wordpress?distro=debian-12",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress?distro=debian-12",
        "input": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "input": "pkg:bitnami/wordpress@6.2.0?distro=debian-12",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?distro=debian-12",
        "input": "pkg:bitnami/wordpress@6.2.0?distro=debian-12",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?distro=debian-12",
        "input": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "arch": "arm64",
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "input": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=debian-12",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=debian-12",
        "input": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=debian-12",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=debian-12",
        "input": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "arch": "arm64",
                "distro": "debian-12",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "arch": "arm64",
                "distro": "photon-4",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "input": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=photon-4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=photon-4",
        "input": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=photon-4",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: bitnami",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:bitnami/wordpress@6.2.0?arch=arm64&distro=photon-4",
        "input": {
            "name": "wordpress",
            "namespace": None,
            "qualifiers": {
                "arch": "arm64",
                "distro": "photon-4",
            },
            "subpath": None,
            "type": "bitnami",
            "version": "6.2.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid maven purl. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io@1.3.4",
        "input": "pkg:maven/org.apache.commons/io@1.3.4",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "1.3.4",
        },
        "input": "pkg:maven/org.apache.commons/io@1.3.4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid maven purl. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io@1.3.4",
        "input": "pkg:maven/org.apache.commons/io@1.3.4",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io@1.3.4",
        "input": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "1.3.4",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "basic valid maven purl without version. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "basic valid maven purl without version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "basic valid maven purl without version. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "basic valid maven purl without version",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "maven often uses qualifiers. Roundtrip an input purl to canonical using mixedcase type",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repository_url=https:%2F%2Frepo.spring.io%2Frelease",
        "input": "pkg:Maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repositorY_url=https://repo.spring.io/release",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "maven often uses qualifiers here mixedcase type",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "sources",
                "repository_url": "https://repo.spring.io/release",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:Maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repositorY_url=https://repo.spring.io/release",
        "test_group": "advanced",
        "test_type": "parse",
    },
    {
        "description": "maven often uses qualifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repository_url=repo.spring.io%2Frelease",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repository_url=repo.spring.io/release",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "maven often uses qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources&repository_url=repo.spring.io%2Frelease",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "sources",
                "repository_url": "repo.spring.io/release",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "maven pom reference. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?repository_url=repo.spring.io%2Frelease&type=pom",
        "input": "pkg:Maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom&repositorY_url=repo.spring.io/release",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "maven pom reference",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "repository_url": "repo.spring.io/release",
                "type": "pom",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:Maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom&repositorY_url=repo.spring.io/release",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "maven pom reference. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?repository_url=https:%2F%2Frepo.spring.io%2Frelease&type=war",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=war&repository_url=https://repo.spring.io/release",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "maven pom reference",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=foo&repository_url=repo.spring.io%2Frelease",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "foo",
                "repository_url": "repo.spring.io/release",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "maven can come with a type qualifier. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "input": "pkg:Maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "maven can come with a type qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jacob",
            "namespace": "net.sf.jacob-project",
            "qualifiers": {
                "classifier": "x86",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "input": "pkg:Maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "maven can come with a type qualifier. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "input": "pkg:maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "maven can come with a type qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-project/jacob@1.14.3?classifier=x86&type=dll",
        "input": {
            "name": "jacob",
            "namespace": "net.sf.jacob-project",
            "qualifiers": {
                "classifier": "x86",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "slash / after type is not significant. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:/maven/org.apache.commons/io",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "slash / after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "input": "pkg:/maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "slash / after type is not significant. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "slash / after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "double slash // after type is not significant. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg://maven/org.apache.commons/io",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "double slash // after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "input": "pkg://maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "double slash // after type is not significant. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "double slash // after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "slash /// after type is not significant. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:///maven/org.apache.commons/io",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "slash /// after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "input": "pkg:///maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "slash /// after type is not significant. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": "pkg:maven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "slash /// after type is not significant",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.commons/io",
        "input": {
            "name": "io",
            "namespace": "org.apache.commons",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid maven purl with case sensitive namespace and name. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "input": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl with case sensitive namespace and name",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "HTTPClient",
            "namespace": "HTTPClient",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "0.3-3",
        },
        "input": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid maven purl with case sensitive namespace and name. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "input": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl with case sensitive namespace and name",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/HTTPClient/HTTPClient@0.3-3",
        "input": {
            "name": "HTTPClient",
            "namespace": "HTTPClient",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "0.3-3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid maven purl containing a space in the version and qualifier. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "input": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl containing a space in the version and qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "myartifact",
            "namespace": "mygroup",
            "qualifiers": {
                "mykey": "my value",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.0.0 Final",
        },
        "input": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid maven purl containing a space in the version and qualifier. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "input": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid maven purl containing a space in the version and qualifier",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/mygroup/myartifact@1.0.0%20Final?mykey=my%20value",
        "input": {
            "name": "myartifact",
            "namespace": "mygroup",
            "qualifiers": {
                "mykey": "my value",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.0.0 Final",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "type": "pom",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "type": "pom",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "sources",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "sources",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "dist",
                "type": "zip",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=zip&classifier=dist",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=dist&type=zip",
        "input": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=zip&classifier=dist",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=dist&type=zip",
        "input": {
            "name": "batik-anim",
            "namespace": "org.apache.xmlgraphics",
            "qualifiers": {
                "classifier": "dist",
                "type": "zip",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.9.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jacob",
            "namespace": "net.sf.jacob-projec",
            "qualifiers": {
                "classifier": "x86",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "input": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll",
        "input": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll",
        "input": {
            "name": "jacob",
            "namespace": "net.sf.jacob-projec",
            "qualifiers": {
                "classifier": "x86",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "jacob",
            "namespace": "net.sf.jacob-projec",
            "qualifiers": {
                "classifier": "x64",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "input": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
        "input": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
        "input": {
            "name": "jacob",
            "namespace": "net.sf.jacob-projec",
            "qualifiers": {
                "classifier": "x64",
                "type": "dll",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.14.3",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "groovy",
            "namespace": "groovy",
            "qualifiers": {
                "repository_url": "https://maven.google.com",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.0",
        },
        "input": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/groovy/groovy@1.0?repository_url=https:%2F%2Fmaven.google.com",
        "input": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: maven",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:maven/groovy/groovy@1.0?repository_url=https:%2F%2Fmaven.google.com",
        "input": {
            "name": "groovy",
            "namespace": "groovy",
            "qualifiers": {
                "repository_url": "https://maven.google.com",
            },
            "subpath": None,
            "type": "maven",
            "version": "1.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "valid conda purl with qualifiers. Roundtrip an input purl to canonical.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "input": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "test_group": "advanced",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conda purl with qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "absl-py",
            "namespace": None,
            "qualifiers": {
                "build": "py36h06a4308_0",
                "channel": "main",
                "subdir": "linux-64",
                "type": "tar.bz2",
            },
            "subpath": None,
            "type": "conda",
            "version": "0.4.1",
        },
        "input": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "valid conda purl with qualifiers. Roundtrip a canonical input to canonical output.",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "input": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "valid conda purl with qualifiers",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "input": {
            "name": "absl-py",
            "namespace": None,
            "qualifiers": {
                "build": "py36h06a4308_0",
                "channel": "main",
                "subdir": "linux-64",
                "type": "tar.bz2",
            },
            "subpath": None,
            "type": "conda",
            "version": "0.4.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Parse test for PURL type: conda",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": {
            "name": "absl-py",
            "namespace": None,
            "qualifiers": {
                "build": "py36h06a4308_0",
                "channel": "main",
                "subdir": "linux-64",
                "type": "tar.bz2",
            },
            "subpath": None,
            "type": "conda",
            "version": "0.4.1",
        },
        "input": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Roundtrip test for PURL type: conda",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "input": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "test_group": "base",
        "test_type": "roundtrip",
    },
    {
        "description": "Build test  for PURL type: conda",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:conda/absl-py@0.4.1?build=py36h06a4308_0&channel=main&subdir=linux-64&type=tar.bz2",
        "input": {
            "name": "absl-py",
            "namespace": None,
            "qualifiers": {
                "build": "py36h06a4308_0",
                "channel": "main",
                "subdir": "linux-64",
                "type": "tar.bz2",
            },
            "subpath": None,
            "type": "conda",
            "version": "0.4.1",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "a scheme is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "a scheme is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "a type is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "a type is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid canonical purl input",
        "expected_output": None,
        "input": "pkg:EnterpriseLibrary.Common@6.0.1304",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "a type is always required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "EnterpriseLibrary.Common",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": None,
            "version": "6.0.1304",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "check for invalid character in type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:n&g?inx/nginx@0.8.9",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "check for null type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from null type",
        "expected_output": None,
        "input": {
            "name": "nginx",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": None,
            "version": "0.8.9",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "check for type that starts with number",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl type (cannot start with number)",
        "expected_output": None,
        "input": "pkg:3nginx/nginx@0.8.9",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "check for type that starts with number",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "nginx",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": None,
            "version": "0.8.9",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "check for colon in type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:nginx:a/nginx@0.8.9",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "check for colon in type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "nginx",
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": None,
            "version": "0.8.9",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "checks for invalid qualifier keys",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:npm/myartifact@1.0.0?in%20production=true",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "checks for invalid qualifier keys",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": "myartifact",
            "namespace": None,
            "qualifiers": {
                "in production": "true",
            },
            "subpath": None,
            "type": "npm",
            "version": "1.0.0",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "a name is required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg:maven/@1.3.4",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "a name is required",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to build a PURL from invalid input components",
        "expected_output": None,
        "input": {
            "name": None,
            "namespace": None,
            "qualifiers": None,
            "subpath": None,
            "type": "maven",
            "version": None,
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "invalid encoded colon : between scheme and type",
        "expected_failure": True,
        "expected_failure_reason": "Should fail to parse a PURL from invalid purl input",
        "expected_output": None,
        "input": "pkg%3Amaven/org.apache.commons/io",
        "test_group": "base",
        "test_type": "parse",
    },
    {
        "description": "Build with multiple checksum",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/openssl@1.1.10g?checksum=sha1:ad9503c3e994a4f%2Csha256:41bf9088b3a1e6c1ef1d",
        "input": {
            "name": "openssl",
            "namespace": None,
            "qualifiers": {
                "checksum": "sha1:ad9503c3e994a4f,sha256:41bf9088b3a1e6c1ef1d",
            },
            "subpath": None,
            "type": "generic",
            "version": "1.1.10g",
        },
        "test_group": "base",
        "test_type": "build",
    },
    {
        "description": "Roundtrip with multiple checksum",
        "expected_failure": False,
        "expected_failure_reason": None,
        "expected_output": "pkg:generic/bitwarderl?checksum=sha1:ad9503c3e994a4f%2Csha256:41bf9088b3a1e6c1ef1d",
        "input": "pkg:generic/bitwarderl?checksum=sha1:ad9503c3e994a4f%2Csha256:41bf9088b3a1e6c1ef1d",
        "test_group": "base",
        "test_type": "roundtrip",
    },
]
